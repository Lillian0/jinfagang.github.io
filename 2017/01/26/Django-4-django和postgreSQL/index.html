<!DOCTYPE html>
<html>
  <!-- Html Head Tag-->
  <head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  <meta name="author" content="Jintian">
  <!-- Open Graph Data -->
  <meta property="og:title" content="Django 4 django和postgreSQL"/>
  <meta property="og:description" content="Just my blog" />
  <meta property="og:site_name" content="Jin Tian"/>
  <meta property="og:type" content="article" />
  <meta property="og:image" content="http://yoursite.comundefined"/>
  
    <link rel="alternate" href="/atom.xml" title="Jin Tian" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  

  <!-- Site Title -->
  <title>Jin Tian</title>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="/css/bootstrap.min.css">
  <!-- Custom CSS -->
  
  <link rel="stylesheet" href="/css/style.dark.css">

  <!-- Google Analytics -->
  

</head>

  <body>
    <!-- Page Header -->


<header class="site-header header-background" style="background-image: url(/img/v.jpg)">
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="page-title with-background-image">
          <p class="title">Django 4 django和postgreSQL</p>
          <p class="subtitle"></p>
        </div>
        <div class="site-menu with-background-image">
          <ul>
            
              <li>
                <a href="/">
                  
                  Home
                  
                </a>
              </li>
            
              <li>
                <a href="/archives">
                  
                  Archives
                  
                </a>
              </li>
            
              <li>
                <a href="/about">
                  
                  About
                  
                </a>
              </li>
            
              <li>
                <a href="/tags">
                  
                  Tag
                  
                </a>
              </li>
            
              <li>
                <a href="/achievements">
                  
                  Achievements
                  
                </a>
              </li>
            
              <li>
                <a href="/resume">
                  
                  Resume
                  
                </a>
              </li>
            
              <li>
                <a href="https://github.com/jinfagang">
                  
                  Github
                  
                </a>
              </li>
            
              <li>
                <a href="mailto:jinfagang19@163.com">
                  
                  Email
                  
                </a>
              </li>
            
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>


<article>
  <div class="container typo">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-info text-muted">
          
            <!-- Author -->
            <span class="author info">By Jintian</span>
          
          <!-- Date -->
          <span class="date-time info">On
            <span class="date">2017-01-26</span>
            <span class="time">13:01:20</span>
          </span>
          
        </div>
        <!-- Tags -->
        
          <div class="post-tags text-muted">
            Tags: 

<a class="tag" href="/tags/Django/">#Django</a>


          </div>
        
        <!-- Post Main Content -->
        <div class="post-content">
          <p>这个教程是要换数据库了，从mysql换到postgresql。说实话我个人以后决定使用postgresql，比mysql方便很多。<br><a id="more"></a></p>
<blockquote>
<p>本文由作者金天原创，欢迎大家转载，不过请保留这段版权信息，多谢合作，如对本文有任何问题欢迎联系作者: jintianiloveu。</p>
</blockquote>
<h3 id="postgresql安装教程"><a href="#postgresql安装教程" class="headerlink" title="postgresql安装教程"></a>postgresql安装教程</h3><p>在这插入一下安装过程，之前安装了现在又重新搭建一遍所以记录一下，其实不管是Mac还是Linux都很简单，直接安装：<br><figure class="highlight mipsasm"><table><tr><td class="code"><pre><div class="line"><span class="comment"># mac</span></div><div class="line"><span class="keyword">brew </span><span class="keyword">install </span>postgresql</div><div class="line"></div><div class="line"><span class="comment"># ubuntu</span></div><div class="line">sudo apt <span class="keyword">install </span>postgresql</div></pre></td></tr></table></figure></p>
<p>当然除了安装数据库之外，还要安装我们需要的python适配器，从而在django中可以调用它，这里我们安装在virtualenv中把，但是之前一直没有用这个，现在也赶一下时髦用一下，其实大家如果不习惯用的话也没有关系，可以直接安装在系统的python目录下。<br><figure class="highlight cmake"><table><tr><td class="code"><pre><div class="line">pip3 <span class="keyword">install</span> psycopg2</div></pre></td></tr></table></figure></p>
<p>这个包是django用来和postgresql通信的python包，如果不安装的话会报错提醒你的。<br>注意在这里django默认使用了pillow来处理图片，因此在安装psycopg2的时候可以顺便把pillow安装一下，搞深度学习的应该都知道这个包，也就是python3下的pil。<br><figure class="highlight cmake"><table><tr><td class="code"><pre><div class="line">pip3 <span class="keyword">install</span> pillow</div></pre></td></tr></table></figure></p>
<h3 id="postgresql一分钟入门"><a href="#postgresql一分钟入门" class="headerlink" title="postgresql一分钟入门"></a>postgresql一分钟入门</h3><p>前几个教程一直是灌输mysql和django的知识，两个人其实配合的很好，今天突然来了第三者，大家可能会有点接受不了。容我解释一下，首先我觉得到目前为止转换的成本其实是很低的，你只需要卸载mysql，重新安装postgresql就可以了。所有的数据都还不多，无所谓。这里说明下我最终选择postgresql的原因：</p>
<ul>
<li>安装简单，没有复杂的密码，访问数据库和表简单</li>
<li>开源就不说了</li>
<li>和django搭配很友好，django其实官方是支持postgresql的</li>
</ul>
<p>最后还有一个很重要的原因就是：<strong>尼玛，sb mysql mac下每次重启系统就重置密码是鸡巴几个意思，shit，气得我直接抛弃了这个二笔</strong> 。</p>
<p>postgresql简单实用教程：<br><figure class="highlight vala"><table><tr><td class="code"><pre><div class="line"><span class="meta"># 创建一个用户</span></div><div class="line">sudo -u postgres createuser --superuser jfg</div><div class="line"><span class="meta"># 以postgres身份进入postgresql控制台</span></div><div class="line">sudo -u postgres psql</div><div class="line"><span class="meta"># 新建一个数据库</span></div><div class="line">sudo -u postgres createdb -O jfg oumenglite</div></pre></td></tr></table></figure></p>
<p>执行上面这些命令你可能觉得一头雾水，下面是postgresql的几条设计逻辑：</p>
<ul>
<li>postgresql是系统级的认证，就是你系统的用户名如果和postgresql用户名相同，则postgresql就不会进行第二步验证</li>
<li>postgresql实行的是每个数据库不同管理员制，也就是说你可以为每个数据库单独设置管理员</li>
</ul>
<p>好了了解了上面两条逻辑，下面运行和几个命令，首先我们创建一个和当前系统用户名相同的postgresql用户，创建完之后你的系统用户就是postgresql的超级用户，不用指定用户也不用输入密码，方便快捷：<br><figure class="highlight ada"><table><tr><td class="code"><pre><div class="line">sudo -U postgres createuser <span class="comment">--superuser yoursysusername</span></div></pre></td></tr></table></figure></p>
<p>这样你就可以直接输入<code>psql</code>来操作数据库了。</p>
<p><strong>[UPDATE 2017-02-1]</strong></p>
<p>更官方的的postgresql使用应该是这样的，你安装完之后会有一个默认的用户postgres，然后：<br><figure class="highlight ada"><table><tr><td class="code"><pre><div class="line">sudo su postgres</div><div class="line">createuser <span class="comment">--interactive -P</span></div></pre></td></tr></table></figure></p>
<p>这是会提示你创建一个新的用户，然后：<br><figure class="highlight ada"><table><tr><td class="code"><pre><div class="line">createdb <span class="comment">--owner yourjusttypename databasename</span></div></pre></td></tr></table></figure></p>
<h3 id="django和postgresql之歌"><a href="#django和postgresql之歌" class="headerlink" title="django和postgresql之歌"></a>django和postgresql之歌</h3><p>现在django之歌要改成django和postgresql之歌了。我们所有的数据都将基于postgresql来构建，我们插入几条数据来看看显示效果：<br><figure class="highlight gherkin"><table><tr><td class="code"><pre><div class="line">from users_user;</div><div class="line">  1 |<span class="string"> 金天 </span>|<span class="string"> 男     </span>|<span class="string"> 1993-12-11 </span>|<span class="string">              </span>|<span class="string">      </span>|<span class="string">             </span>|<span class="string"> lewisjin@outlook.com </span>|<span class="string">        </span>|<span class="string">         </span>|<span class="string"> 长沙        </span>|</div><div class="line">  2 |<span class="string"> 小芳 </span>|<span class="string"> 女     </span>|<span class="string"> 1993-12-11 </span>|<span class="string">              </span>|<span class="string">      </span>|<span class="string">             </span>|<span class="string"> xiaof@qq.com         </span>|<span class="string">        </span>|<span class="string">         </span>|<span class="string"> 北京        </span>|</div><div class="line">  3 |<span class="string"> 刘明 </span>|<span class="string"> 男     </span>|<span class="string"> 1993-12-11 </span>|<span class="string">              </span>|<span class="string"> 浙江  </span>|<span class="string"> 15116378920 </span>|<span class="string"> xiaof@qq.com         </span>|<span class="string">        </span>|<span class="string">         </span>|<span class="string"> 北京        </span>|</div></pre></td></tr></table></figure></p>
<p>感觉数据多的情况下，postgresql的控制台显示效果都比mysql的好，而且你上手postgresql只需要知道这么几条命令就够了：<br><figure class="highlight vala"><table><tr><td class="code"><pre><div class="line"><span class="meta"># 新建数据库</span></div><div class="line">createdb ara</div><div class="line"></div><div class="line"><span class="meta"># 选择数据库</span></div><div class="line">psql ara</div><div class="line"></div><div class="line"><span class="meta"># 显示所有数据库</span></div><div class="line">psql -l</div><div class="line"></div><div class="line"><span class="meta"># 显示数据库下的所有表</span></div><div class="line">\d</div></pre></td></tr></table></figure></p>
<p>就是这么simple。你已经从mysql转移到了postgresql！</p>
<h3 id="django继续我们的api"><a href="#django继续我们的api" class="headerlink" title="django继续我们的api"></a>django继续我们的api</h3><p>时隔很久了，这个教程只要继续我们的django代建restful api的伟大事业。</p>

        </div>
      </div>
    </div>
  </div>
</article>



    <!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <p class="copyright text-muted">
          Copyright <a target="_blank" href="https://github.com/jinfagang">Jintian</a>
          An Intelligent Scientist
          </p>
        <p class="copyright text-muted">
          Powered By <a target="_blank" href="https://hexo.io/">DeepX</a>
        </p>
      </div>
    </div>
  </div>
</footer>


    <!-- After Footer Scripts -->
<script src="/js/highlight.pack.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function(event) {
    var codeBlocks = Array.prototype.slice.call(document.getElementsByTagName('pre'))
    codeBlocks.forEach(function(block, index) {
      hljs.highlightBlock(block);
    });
  });
</script>

  </body>
</html>

